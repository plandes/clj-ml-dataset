<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>zensols.dataset.db documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Generate, split into folds or train/test and cache a dataset</span> <span class="project-version">0.0.12</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>zensols</span></div></div></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>dataset</span></div></div></li><li class="depth-3 branch current"><a href="zensols.dataset.db.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>db</span></div></a></li><li class="depth-3 branch"><a href="zensols.dataset.elsearch.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>elsearch</span></div></a></li><li class="depth-3 branch"><a href="zensols.dataset.thaw.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>thaw</span></div></a></li><li class="depth-3"><a href="zensols.dataset.version.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>version</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="zensols.dataset.db.html#var-class-label-key"><div class="inner"><span>class-label-key</span></div></a></li><li class="depth-1"><a href="zensols.dataset.db.html#var-clear"><div class="inner"><span>clear</span></div></a></li><li class="depth-1"><a href="zensols.dataset.db.html#var-dataset-file"><div class="inner"><span>dataset-file</span></div></a></li><li class="depth-1"><a href="zensols.dataset.db.html#var-default-connection-inst"><div class="inner"><span>default-connection-inst</span></div></a></li><li class="depth-1"><a href="zensols.dataset.db.html#var-distribution"><div class="inner"><span>distribution</span></div></a></li><li class="depth-1"><a href="zensols.dataset.db.html#var-divide-by-fold"><div class="inner"><span>divide-by-fold</span></div></a></li><li class="depth-1"><a href="zensols.dataset.db.html#var-divide-by-preset"><div class="inner"><span>divide-by-preset</span></div></a></li><li class="depth-1"><a href="zensols.dataset.db.html#var-divide-by-set"><div class="inner"><span>divide-by-set</span></div></a></li><li class="depth-1"><a href="zensols.dataset.db.html#var-elasticsearch-connection"><div class="inner"><span>elasticsearch-connection</span></div></a></li><li class="depth-1"><a href="zensols.dataset.db.html#var-freeze-dataset"><div class="inner"><span>freeze-dataset</span></div></a></li><li class="depth-1"><a href="zensols.dataset.db.html#var-freeze-dataset-to-writer"><div class="inner"><span>freeze-dataset-to-writer</span></div></a></li><li class="depth-1"><a href="zensols.dataset.db.html#var-freeze-file"><div class="inner"><span>freeze-file</span></div></a></li><li class="depth-1"><a href="zensols.dataset.db.html#var-id-key"><div class="inner"><span>id-key</span></div></a></li><li class="depth-1"><a href="zensols.dataset.db.html#var-ids"><div class="inner"><span>ids</span></div></a></li><li class="depth-1"><a href="zensols.dataset.db.html#var-instance-by-id"><div class="inner"><span>instance-by-id</span></div></a></li><li class="depth-1"><a href="zensols.dataset.db.html#var-instance-count"><div class="inner"><span>instance-count</span></div></a></li><li class="depth-1"><a href="zensols.dataset.db.html#var-instance-key"><div class="inner"><span>instance-key</span></div></a></li><li class="depth-1"><a href="zensols.dataset.db.html#var-instances"><div class="inner"><span>instances</span></div></a></li><li class="depth-1"><a href="zensols.dataset.db.html#var-instances-by-class-label"><div class="inner"><span>instances-by-class-label</span></div></a></li><li class="depth-1"><a href="zensols.dataset.db.html#var-instances-count"><div class="inner"><span>instances-count</span></div></a></li><li class="depth-1"><a href="zensols.dataset.db.html#var-instances-load"><div class="inner"><span>instances-load</span></div></a></li><li class="depth-1"><a href="zensols.dataset.db.html#var-set-default-connection"><div class="inner"><span>set-default-connection</span></div></a></li><li class="depth-1"><a href="zensols.dataset.db.html#var-set-default-set-type"><div class="inner"><span>set-default-set-type</span></div></a></li><li class="depth-1"><a href="zensols.dataset.db.html#var-set-fold"><div class="inner"><span>set-fold</span></div></a></li><li class="depth-1"><a href="zensols.dataset.db.html#var-set-population-use"><div class="inner"><span>set-population-use</span></div></a></li><li class="depth-1"><a href="zensols.dataset.db.html#var-stats"><div class="inner"><span>stats</span></div></a></li><li class="depth-1"><a href="zensols.dataset.db.html#var-with-connection"><div class="inner"><span>with-connection</span></div></a></li><li class="depth-1"><a href="zensols.dataset.db.html#var-write-dataset"><div class="inner"><span>write-dataset</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">zensols.dataset.db</h1><div class="doc"><div class="markdown"><p>Preemptively compute a dataset (i.e. features from natural language utterances) and store them in Elasticsearch. This is useful for use with training, testing, validating and development machine learning models.</p>
<p>The unit of data is an instance. An instance set (or just <em>instances</em>) makes up the dataset.</p>
<p>The idea is to abstract out Elasticsearch, but that might be a future enhancement. At the moment functions don’t carry Elassticsearch artifacts but they are exposed.</p>
<p>There are three basic ways to use this data:</p>
<ul>
  <li>Get all instances (i.e. an utterance or a feature set). In this case all  data returned from <a href="zensols.dataset.db.html#var-ids">ids</a> is considered training data. This is the default  nascent state.</li>
  <li>Split the data into a train and test set (see <a href="zensols.dataset.db.html#var-divide-by-set">divide-by-set</a>).</li>
  <li>Use the data as a cross fold validation and iterate  folds (see <a href="zensols.dataset.db.html#var-divide-by-fold">divide-by-fold</a>).</li>
</ul>
<p>The information used to represent either fold or the test/train split is referred to as the <em>dataset split</em> state and is stored in Elasticsearch under a differnent mapping-type in the same index as the instances.</p>
<p>See <a href="zensols.dataset.db.html#var-ids">ids</a> for more information.</p></div></div><div class="public anchor" id="var-class-label-key"><h3>class-label-key</h3><div class="usage"></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-dataset/blob/v0.0.12/src/clojure/zensols/dataset/db.clj#L45">view source</a></div></div><div class="public anchor" id="var-clear"><h3>clear</h3><div class="usage"><code>(clear &amp; {:keys [wipe-persistent?], :or {wipe-persistent? false}})</code></div><div class="doc"><div class="markdown"><p>Clear the in memory instance data. If key <code>:wipe-persistent?</code> is <code>true</code> all fold and test/train split data is also cleared.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-dataset/blob/v0.0.12/src/clojure/zensols/dataset/db.clj#L216">view source</a></div></div><div class="public anchor" id="var-dataset-file"><h3>dataset-file</h3><div class="usage"><code>(dataset-file)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-dataset/blob/v0.0.12/src/clojure/zensols/dataset/db.clj#L616">view source</a></div></div><div class="public anchor" id="var-default-connection-inst"><h3>default-connection-inst</h3><div class="usage"></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-dataset/blob/v0.0.12/src/clojure/zensols/dataset/db.clj#L61">view source</a></div></div><div class="public anchor" id="var-distribution"><h3>distribution</h3><div class="usage"><code>(distribution)</code></div><div class="doc"><div class="markdown"><p>Return maps representing the data set distribution by class label. Each element of the returned sequence has the following keys:</p>
<ul>
  <li><strong>:class-label</strong> the class-label fo the instances</li>
  <li><strong>:count</strong> the number of instances for <strong>:class-label</strong></li>
</ul></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-dataset/blob/v0.0.12/src/clojure/zensols/dataset/db.clj#L481">view source</a></div></div><div class="public anchor" id="var-divide-by-fold"><h3>divide-by-fold</h3><div class="usage"><code>(divide-by-fold)</code><code>(divide-by-fold folds &amp; {:keys [shuffle?], :or {shuffle? true}})</code></div><div class="doc"><div class="markdown"><p>Divide the data into folds and initialize the current fold in the <em>dataset split</em> state. Using this kind of dataset split is useful for cross fold validation.</p>
<ul>
  <li><strong>folds</strong> number of folds to use, which defaults to 10</li>
</ul>
<p>See <a href="zensols.dataset.db.html#var-set-fold">set-fold</a></p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-dataset/blob/v0.0.12/src/clojure/zensols/dataset/db.clj#L412">view source</a></div></div><div class="public anchor" id="var-divide-by-preset"><h3>divide-by-preset</h3><div class="usage"><code>(divide-by-preset)</code></div><div class="doc"><div class="markdown"><p>Divide the data into test and training <em>buckets</em>. The respective train/test buckets are dictated by the <code>:set-type</code> label given in parameter given to the <strong>:create-instances-fn</strong> as documented in <a href="zensols.dataset.db.html#var-elasticsearch-connection">elasticsearch-connection</a>.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-dataset/blob/v0.0.12/src/clojure/zensols/dataset/db.clj#L389">view source</a></div></div><div class="public anchor" id="var-divide-by-set"><h3>divide-by-set</h3><div class="usage"><code>(divide-by-set)</code><code>(divide-by-set train-ratio &amp; {:keys [dist-type shuffle? max-instances seed], :as opts, :or {shuffle? true, dist-type (quote uneven)}})</code></div><div class="doc"><div class="markdown"><p>Divide the dataset into a test and training <em>buckets</em>.</p>
<ul>
  <li><strong>train-ratio</strong> this is the percentage of data in the train bucket, which defaults to <code>0.5</code></li>
</ul>
<h2><a href="#keys" name="keys"></a>Keys</h2>
<ul>
  <li><strong>:dist-type</strong> one of the following symbols: <em>even</em> each test/training set has an even distribution by class label <em>uneven</em> each test/training set has an uneven distribution by class label</li>
  <li><strong>:shuffle?</strong> if <code>true</code> then shuffle the set before partitioning, otherwise just update the <em>demarcation</em> boundary</li>
  <li><strong>:filter-fn</strong> if given a filter function that takes a key as input</li>
  <li><strong>:max-instances</strong> the maximum number of instances per class</li>
  <li><strong>:seed</strong> if given, seed the random number generator, otherwise don’t return random documents</li>
</ul></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-dataset/blob/v0.0.12/src/clojure/zensols/dataset/db.clj#L588">view source</a></div></div><div class="public anchor" id="var-elasticsearch-connection"><h3>elasticsearch-connection</h3><div class="usage"><code>(elasticsearch-connection index-name &amp; {:keys [create-instances-fn population-use set-type url mapping-type-def cache-inst], :or {create-instances-fn identity, population-use 1.0, set-type :train, mapping-type-def {instance-key {:type "nested"}, class-label-key {:type "string", :index "not_analyzed"}}, url "http://localhost:9200"}})</code></div><div class="doc"><div class="markdown"><p>Create a connection to the dataset DB cache.</p>
<h2><a href="#parameters" name="parameters"></a>Parameters</h2>
<ul>
  <li><strong>index-name</strong> the name of the Elasticsearch index</li>
</ul>
<h2><a href="#keys" name="keys"></a>Keys</h2>
<ul>
  <li>
    <p><strong>:create-instances-fn</strong> a function that computes the instance set (i.e. parses the utterance) and invoked by <a href="zensols.dataset.db.html#var-instances-load">instances-load</a>; this function takes a single argument, which is also a function that is used to load utterance in the DB; this function takes the following forms:</p>
    <ul>
      <li>(fn [instance class-label] …</li>
      <li>(fn [id instance class-label] …</li>
      <li>(fn [id instance class-label set-type] …
        <ul>
          <li><strong>id</strong> the unique identifier of the data point</li>
          <li><strong>instance</strong> is the data set instance (can be an <code>N</code>-deep map)</li>
          <li><strong>class-label</strong> the label of the class (can be nominal, double, integer)</li>
          <li><strong>set-type</strong> either <code>:test</code>, <code>:train</code>, <code>:train-test</code> (all) used to presort the data with <a href="zensols.dataset.db.html#var-divide-by-preset">divide-by-preset</a>; note that it isn’t necessary to call <a href="zensols.dataset.db.html#var-divide-by-preset">divide-by-preset</a> for the first invocation of <a href="zensols.dataset.db.html#var-instances-load">instances-load</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li>
  <p><strong>:url</strong> the URL to the DB (defaults to <code>http://localhost:9200</code>)</p></li>
  <li><strong>:mapping-type</strong> map type name (see ES docs)</li>
  <li><strong>:cache-inst</strong> an atom used to cache instances by ID; if given this retrieves instances from the in memory map stored in the atom; otherwise it goes to ElasticSearch each time</li>
</ul>
<h2><a href="#example" name="example"></a>Example</h2>
<p>Create a connection that produces a list of 20 instances:</p>
<pre><code class="clojure">(defn- create-iter-connection []
  (letfn [(load-fn [add-fn]
            (doseq [i (range 20)]
              (add-fn (str i) (format "inst %d" i) (format "class %d" i))))]
    (elasticsearch-connection "tmp" :create-instances-fn load-fn)))
</code></pre></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-dataset/blob/v0.0.12/src/clojure/zensols/dataset/db.clj#L63">view source</a></div></div><div class="public anchor" id="var-freeze-dataset"><h3>freeze-dataset</h3><div class="usage"><code>(freeze-dataset &amp; {:keys [output-file id-key set-type-key], :or {set-type-key :set-type}})</code></div><div class="doc"><div class="markdown"><p>Distille the current data set (data and test/train splits) in a <strong>output-file</strong>. See <a href="zensols.dataset.db.html#var-freeze-dataset-to-writer">freeze-dataset-to-writer</a>.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-dataset/blob/v0.0.12/src/clojure/zensols/dataset/db.clj#L707">view source</a></div></div><div class="public anchor" id="var-freeze-dataset-to-writer"><h3>freeze-dataset-to-writer</h3><div class="usage"><code>(freeze-dataset-to-writer writer &amp; {:keys [set-type-key]})</code></div><div class="doc"><div class="markdown"><p>Distille the current data set (data and test/train splits) in <strong>writer</strong> to be later restored with<a href="null">zensols.dataset.thaw/taw-connection</a>.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-dataset/blob/v0.0.12/src/clojure/zensols/dataset/db.clj#L690">view source</a></div></div><div class="public anchor" id="var-freeze-file"><h3>freeze-file</h3><div class="usage"><code>(freeze-file)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-dataset/blob/v0.0.12/src/clojure/zensols/dataset/db.clj#L685">view source</a></div></div><div class="public anchor" id="var-id-key"><h3>id-key</h3><div class="usage"></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-dataset/blob/v0.0.12/src/clojure/zensols/dataset/db.clj#L43">view source</a></div></div><div class="public anchor" id="var-ids"><h3>ids</h3><div class="usage"><code>(ids &amp; {:keys [set-type]})</code></div><div class="doc"><div class="markdown"><p>Return all IDs based on the <em>dataset split</em> (see class docs).</p>
<h2><a href="#keys" name="keys"></a>Keys</h2>
<ul>
  <li><strong>:set-type</strong> is either <code>:train</code>, <code>:test</code>, <code>:train-test</code> (all) and defaults to <a href="zensols.dataset.db.html#var-set-default-set-type">set-default-set-type</a> or <code>:train</code> if not set</li>
</ul></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-dataset/blob/v0.0.12/src/clojure/zensols/dataset/db.clj#L313">view source</a></div></div><div class="public anchor" id="var-instance-by-id"><h3>instance-by-id</h3><div class="usage"><code>(instance-by-id conn id)</code><code>(instance-by-id id)</code></div><div class="doc"><div class="markdown"><p>Get a specific instance by its ID.</p>
<p>This returns a map that has the following keys:</p>
<ul>
  <li><strong>:instance</strong> the instance data, which was set with <strong>:create-instances-fn</strong> in <a href="zensols.dataset.db.html#var-elasticsearch-connection">elasticsearch-connection</a></li>
</ul></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-dataset/blob/v0.0.12/src/clojure/zensols/dataset/db.clj#L194">view source</a></div></div><div class="public anchor" id="var-instance-count"><h3>instance-count</h3><div class="usage"><code>(instance-count)</code></div><div class="doc"><div class="markdown"><p>Get the number of total instances in the database. This result is independent of the <em>dataset split</em> state.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-dataset/blob/v0.0.12/src/clojure/zensols/dataset/db.clj#L261">view source</a></div></div><div class="public anchor" id="var-instance-key"><h3>instance-key</h3><div class="usage"></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-dataset/blob/v0.0.12/src/clojure/zensols/dataset/db.clj#L41">view source</a></div></div><div class="public anchor" id="var-instances"><h3>instances</h3><div class="usage"><code>(instances &amp; {:keys [set-type include-ids? id-set]})</code></div><div class="doc"><div class="markdown"><p>Return all instance data based on the <em>dataset split</em> (see class docs).</p>
<p>See <a href="zensols.dataset.db.html#var-instance-by-id">instance-by-id</a> for the data in each map sequence returned.</p>
<h2><a href="#keys" name="keys"></a>Keys</h2>
<ul>
  <li><strong>:set-type</strong> is either <code>:train</code>, <code>:test</code>, <code>:train-test</code> (all) and defaults to <a href="zensols.dataset.db.html#var-set-default-set-type">set-default-set-type</a> or <code>:train</code> if not set</li>
  <li><strong>:include-ids?</strong> if non-<code>nil</code> return keys in the map as well</li>
</ul></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-dataset/blob/v0.0.12/src/clojure/zensols/dataset/db.clj#L330">view source</a></div></div><div class="public anchor" id="var-instances-by-class-label"><h3>instances-by-class-label</h3><div class="usage"><code>(instances-by-class-label &amp; {:keys [max-instances type seed], :or {max-instances Integer/MAX_VALUE}})</code></div><div class="doc"><div class="markdown"><p>Return a map with class-labels for keys and corresponding instances for that class-label.</p>
<h2><a href="#keys" name="keys"></a>Keys</h2>
<ul>
  <li><strong>:max-instances</strong> the maximum number of instances per class</li>
  <li><strong>:seed</strong> if given, seed the random number generator, otherwise don’t return random documents</li>
</ul></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-dataset/blob/v0.0.12/src/clojure/zensols/dataset/db.clj#L493">view source</a></div></div><div class="public anchor" id="var-instances-count"><h3>instances-count</h3><div class="usage"><code>(instances-count)</code></div><div class="doc"><div class="markdown"><p>Return the number of datasets in the DB.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-dataset/blob/v0.0.12/src/clojure/zensols/dataset/db.clj#L187">view source</a></div></div><div class="public anchor" id="var-instances-load"><h3>instances-load</h3><div class="usage"><code>(instances-load &amp; {:keys [recreate-index?], :or {recreate-index? true}})</code></div><div class="doc"><div class="markdown"><p>Parse and load the dataset in the DB.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-dataset/blob/v0.0.12/src/clojure/zensols/dataset/db.clj#L454">view source</a></div></div><div class="public anchor" id="var-set-default-connection"><h3>set-default-connection</h3><div class="usage"><code>(set-default-connection)</code><code>(set-default-connection conn)</code></div><div class="doc"><div class="markdown"><p>Set the default connection.</p>
<p>Parameter <strong>conn</strong> is used in place of what is set with <a href="zensols.dataset.db.html#var-with-connection">with-connection</a>. This is very convenient and saves typing, but will get clobbered if a <a href="zensols.dataset.db.html#var-with-connection">with-connection</a> is used further down in the stack frame.</p>
<p>If the parameter is missing, it’s unset.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-dataset/blob/v0.0.12/src/clojure/zensols/dataset/db.clj#L161">view source</a></div></div><div class="public anchor" id="var-set-default-set-type"><h3>set-default-set-type</h3><div class="usage"><code>(set-default-set-type set-type)</code></div><div class="doc"><div class="markdown"><p>Set the default bucket (training or testing) to get data.</p>
<ul>
  <li><strong>:set-type</strong> is either <code>:train</code> (default) or <code>:test</code>; see <a href="zensols.dataset.db.html#var-elasticsearch-connection">elasticsearch-connection</a></li>
</ul>
<p>See <a href="zensols.dataset.db.html#var-ids">ids</a></p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-dataset/blob/v0.0.12/src/clojure/zensols/dataset/db.clj#L176">view source</a></div></div><div class="public anchor" id="var-set-fold"><h3>set-fold</h3><div class="usage"><code>(set-fold fold)</code></div><div class="doc"><div class="markdown"><p>Set the current fold in the <em>dataset split</em> state.</p>
<p>You must call <a href="zensols.dataset.db.html#var-divide-by-fold">divide-by-fold</a> before calling this.</p>
<p>See the namespace docs for more information.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-dataset/blob/v0.0.12/src/clojure/zensols/dataset/db.clj#L366">view source</a></div></div><div class="public anchor" id="var-set-population-use"><h3>set-population-use</h3><div class="usage"><code>(set-population-use ratio)</code></div><div class="doc"><div class="markdown"><p>Set how much of the data from the DB to use. This is useful for cases where your dataset or corpus is huge and you only want to start with a small chunk until you get your models debugged.</p>
<h2><a href="#parameters" name="parameters"></a>Parameters</h2>
<ul>
  <li><strong>ratio</strong> a number between (0-1]; by default this is 1</li>
</ul>
<p><strong>Note</strong> This removes any stored <em>dataset split</em> state</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-dataset/blob/v0.0.12/src/clojure/zensols/dataset/db.clj#L227">view source</a></div></div><div class="public anchor" id="var-stats"><h3>stats</h3><div class="usage"><code>(stats)</code></div><div class="doc"><div class="markdown"><p>Get training vs testing <em>dataset split</em> statistics.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-dataset/blob/v0.0.12/src/clojure/zensols/dataset/db.clj#L347">view source</a></div></div><div class="public anchor" id="var-with-connection"><h3>with-connection</h3><h4 class="type">macro</h4><div class="usage"><code>(with-connection connection &amp; body)</code></div><div class="doc"><div class="markdown"><p>Execute a body with the form (with-connection connection …)</p>
<ul>
  <li><strong>connection</strong> is created with <a href="zensols.dataset.db.html#var-elasticsearch-connection">elasticsearch-connection</a></li>
</ul></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-dataset/blob/v0.0.12/src/clojure/zensols/dataset/db.clj#L131">view source</a></div></div><div class="public anchor" id="var-write-dataset"><h3>write-dataset</h3><div class="usage"><code>(write-dataset &amp; {:keys [output-file single? instance-fn columns-fn], :or {instance-fn identity, columns-fn (constantly ["Instance"])}})</code></div><div class="doc"><div class="markdown"><p>Write the data set to a spreadsheet. If the file name ends with a <code>.csv</code> a CSV file is written, otherwise an Excel file is written.</p>
<h2><a href="#keys" name="keys"></a>Keys</h2>
<ul>
  <li><strong>:output-file</strong> where to write the file and defaults to <a href="null">res/resource-path</a> <code>:analysis-report</code></li>
  <li><strong>:single?</strong> if <code>true</code> then create a single sheet, otherwise the training and testing <em>buckets</em> are split between sheets</li>
</ul></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-dataset/blob/v0.0.12/src/clojure/zensols/dataset/db.clj#L634">view source</a></div></div></div></body></html>